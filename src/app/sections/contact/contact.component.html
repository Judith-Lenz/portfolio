<section>
  <div class="headline-container">
    <div class="line"></div>
    <div class="headline">{{ "contact.headline" | translate }}</div>
  </div>
  <div class="content">
    <div class="info">
      <div class="question">{{ "contact.intro.question" | translate }}</div>
      <div class="info-text">
        {{ "contact.intro.infotext" | translate }}
      </div>
      <div
        class="info-cta"
        [innerHTML]="'contact.intro.infocta' | translate"
      ></div>
    </div>

    <form
      [formGroup]="contactForm"
      (ngSubmit)="onSubmit()"
      class="contact-form"
    >
      <div class="input-wrapper">
        <input
          type="text"
          formControlName="name"
          placeholder="{{ 'contact.form.name' | translate }}"
          id="name"
          [ngClass]="{
            valid:
              contactForm.get('name')?.valid &&
              contactForm.get('name')?.touched,
            invalid:
              contactForm.get('name')?.invalid &&
              contactForm.get('name')?.touched
          }"
        />
        <img
          src="assets/icon/check.svg"
          alt="valid"
          class="icon valid-icon"
          *ngIf="
            contactForm.get('name')?.valid && contactForm.get('name')?.touched
          "
        />
        <img
          src="assets/icon/alert.svg"
          alt="invalid"
          class="icon invalid-icon"
          *ngIf="
            contactForm.get('name')?.invalid && contactForm.get('name')?.touched
          "
        />

        <div class="error-slot">
          <small
            class="error-msg"
            *ngIf="
              contactForm.get('name')?.hasError('required') &&
                contactForm.get('name')?.touched;
              else nameMinErr
            "
          >
            {{ "contact.form.error.nameRequired" | translate }}
          </small>
          <ng-template #nameMinErr>
            <small
              class="error-msg"
              *ngIf="
                contactForm.get('name')?.hasError('minlength') &&
                contactForm.get('name')?.touched
              "
            >
              {{ "contact.form.error.nameMinLength" | translate }}
            </small>
          </ng-template>
        </div>
      </div>

      <div class="input-wrapper">
        <input
          type="email"
          formControlName="email"
          id="email"
          placeholder="{{ 'contact.form.email' | translate }}"
          [ngClass]="{
            valid:
              contactForm.get('email')?.valid &&
              contactForm.get('email')?.touched,
            invalid:
              contactForm.get('email')?.invalid &&
              contactForm.get('email')?.touched
          }"
        />
        <img
          src="assets/icon/check.svg"
          alt="valid"
          class="icon valid-icon"
          *ngIf="
            contactForm.get('email')?.valid && contactForm.get('email')?.touched
          "
        />
        <img
          src="assets/icon/alert.svg"
          alt="invalid"
          class="icon invalid-icon"
          *ngIf="
            contactForm.get('email')?.invalid &&
            contactForm.get('email')?.touched
          "
        />

        <div class="error-slot">
          <small
            class="error-msg"
            *ngIf="
              contactForm.get('email')?.hasError('required') &&
                contactForm.get('email')?.touched;
              else emailPatternErr
            "
          >
            {{ "contact.form.error.emailRequired" | translate }}
          </small>
          <ng-template #emailPatternErr>
            <small
              class="error-msg"
              *ngIf="
                contactForm.get('email')?.hasError('pattern') &&
                contactForm.get('email')?.touched
              "
            >
              {{ "contact.form.error.emailInvalid" | translate }}
            </small>
          </ng-template>
        </div>
      </div>

      <div class="input-wrapper">
        <textarea
          formControlName="message"
          id="message"
          placeholder="{{ 'contact.form.message' | translate }}"
          [ngClass]="{
            valid:
              contactForm.get('message')?.valid &&
              contactForm.get('message')?.touched,
            invalid:
              contactForm.get('message')?.invalid &&
              contactForm.get('message')?.touched
          }"
        ></textarea>
        <img
          src="assets/icon/check.svg"
          alt="valid"
          class="icon valid-icon"
          *ngIf="
            contactForm.get('message')?.valid &&
            contactForm.get('message')?.touched
          "
        />
        <img
          src="assets/icon/alert.svg"
          alt="invalid"
          class="icon invalid-icon"
          *ngIf="
            contactForm.get('message')?.invalid &&
            contactForm.get('message')?.touched
          "
        />

        <div class="error-slot">
          <small
            class="error-msg"
            *ngIf="
              contactForm.get('message')?.hasError('required') &&
              contactForm.get('message')?.touched
            "
          >
            {{ "contact.form.error.messageRequired" | translate }}
          </small>
        </div>
      </div>

      <div class="checkbox-wrapper">
        <label class="custom-checkbox">
          <input type="checkbox" formControlName="privacy" id="privacy" />
          <span class="checkmark"></span>
          <span class="checkbox-text">
            {{ "contact.form.privacy" | translate }}
            <a
              routerLink="/privacy-policy"
              (click)="formCache.setForm(contactForm.value)"
            >
              {{ "contact.form.privacyLink" | translate }}
            </a>
            {{ "contact.form.privacySuffix" | translate }}
          </span>
        </label>

        <div class="error-slot">
          <small
            class="error-msg"
            *ngIf="
              contactForm.get('privacy')?.invalid &&
              (contactForm.get('privacy')?.touched ||
                contactForm.get('privacy')?.dirty)
            "
          >
            {{ "contact.form.error.privacyRequired" | translate }}
          </small>
        </div>
      </div>

      <button
        type="submit"
        [disabled]="isSubmitting"
        [ngClass]="{
          'btn-valid': contactForm.valid,
          'btn-disabled': !contactForm.valid,
          'btn-sending': submissionStatus === 'sending',
          'btn-error': submissionStatus === 'error'
        }"
      >
        <ng-container [ngSwitch]="submissionStatus">
          <span *ngSwitchCase="'sending'">
            {{ "contact.form.submitSending" | translate }}
          </span>
          <span *ngSwitchCase="'error'">
            {{ "contact.form.submitError" | translate }}
          </span>
          <span *ngSwitchDefault>
            {{ "contact.form.send" | translate }}
          </span>
        </ng-container>
      </button>
    </form>
  </div>
  <button
    (click)="goToTop()"
    class="back-to-top"
    (mouseenter)="hover = true"
    (mouseleave)="hover = false"
  >
    <img
      [src]="
        hover
          ? 'assets/icon/goupbuttongreen.svg'
          : 'assets/icon/goupbuttonwhite.svg'
      "
      alt="UpToTopArrow"
    />
  </button>
  <img
    class="shadow"
    src="assets/image/33. Purple shadow Footer.png"
    alt="shadow_about"
  />
  <div
    class="success-overlay"
    *ngIf="showSuccessOverlay"
    role="dialog"
    aria-modal="true"
    aria-live="polite"
    [attr.aria-label]="'contact.overlay.ariaLabel' | translate"
  >
    <div class="success-card">
      <img src="assets/icon/check.svg" alt="" class="success-icon" />
      <h3>{{ "contact.overlay.title" | translate }}</h3>
      <p class="success-text">{{ "contact.overlay.text" | translate }}</p>
    </div>
  </div>
</section>
